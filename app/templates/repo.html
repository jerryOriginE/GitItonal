{% extends "base.html" %}

{% block content %}
<h2>Repository: {{ repo_name }}</h2>

<p><a href="/">â† Back to repository list</a></p>

{% if tree_path %}
  <p>
    <strong>Path:</strong>
    <a href="/repo/{{ repo_name }}">/</a>
    {% set segments = tree_path.split('/') %}
    {% set current = [] %}
    {% for seg in segments %}
      {% set _ = current.append(seg) %}
      / <a href="/repo/{{ repo_name }}/tree/{{ '/'.join(current) }}">{{ seg }}</a>
    {% endfor %}
  </p>
{% endif %}

{% if entries %}
<h3>Contents</h3>
<div class="files-list">
  {% if tree_path %}
  <span class="file-icon">ğŸ“</span>
  <a href="/repo/{{ repo_name }}/tree/{{ tree_path.rsplit('/', 1)[0] if '/' in tree_path else '' }}">..</a>
  {% endif %}
  {% for entry in entries %}
  <div class="file-item">
    {% if entry.type == 'tree' %}
      <span class="file-icon">ğŸ“</span>
      <a class="file-name" href="/repo/{{ repo_name }}/tree/{{ entry.path }}">{{ entry.name }}</a>
    {% else %}
      <span class="file-icon">ğŸ“„</span>
      <a href="/repo/{{ repo_name }}/file/{{ entry.path }}">{{ entry.name }}</a>
    {% endif %}
  </div>
  {% endfor %}
</div>
{% endif %}

{% if commits %}
<h3>Commits</h3>
<table>
  <tr>
    <th>Commit</th>
    <th>Message</th>
  </tr>
  {% for c in commits %}
  <tr>
    <td>{{ c.hash }}</td>
    <td>{{ c.message }}</td>
  </tr>
  {% endfor %}
</table>
{% else %}
<p><em>No commits found.</em></p>
{% endif %}
{% endblock %}
